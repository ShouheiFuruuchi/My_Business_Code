#1188999007000
#ç¦è¢‹åœ¨åº«é›†è¨ˆ


#----------------------------------------------------------------------------------------------


import time
import selenium
from selenium import webdriver
from selenium.webdriver.support.ui import Select
from selenium.webdriver import ChromeOptions
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
import datetime
import os
import glob
import shutil
from operator import itemgetter
import datetime
import pandas as pd
import re
import numpy as np
import collections
import requests
import openpyxl as pyxl
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.chrome.service import Service as ChromeServeice
#

#ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯åº—åˆ¥å“ç•ªåˆ¥å®Ÿç¸¾ã‚’è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã†

#ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼è²©å£²NETã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

kasiwa = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[3]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[3]','æŸ','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[3]',"01001008 FUNæŸ","01001008",]
chiba = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[4]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[4]', 'åƒè‘‰','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[4]',"01001009 FUNåƒè‘‰C-one","01001009",]
isesaki = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[9]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[9]','ä¼Šå‹¢å´','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[9]',"01001028 FUNã‚¹ãƒãƒ¼ã‚¯ä¼Šå‹¢å´","01001028",]
nagamachi = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[11]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[11]','é•·ç”º','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[11]',"01001032 FUNãƒ©ãƒ©ã‚¬ãƒ¼ãƒ‡ãƒ³é•·ç”º","01001032",]
hunabashi = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[12]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[12]','èˆ¹æ©‹','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[12]',"01001033 FUNã‚‰ã‚‰ã½ãƒ¼ã¨TOKYO-BAY","01001033",]
hujimi = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[13]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[13]','å¯Œå£«è¦‹','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[13]',"01001034 FUNã‚‰ã‚‰ã½ãƒ¼ã¨å¯Œå£«è¦‹","01001034",]
reiku = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[15]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[15]','ãƒ¬ã‚¤ã‚¯','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[15]',"01001036 FUNã‚¤ã‚ªãƒ³ãƒ¬ã‚¤ã‚¯ã‚¿ã‚¦ãƒ³","01001036",]
ebina = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[17]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[17]','æµ·è€å','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[17]',"01001038 FUNã‚‰ã‚‰ã½ãƒ¼ã¨æµ·è€å","01001038",]
musashi = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[18]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[18]','ã‚€ã•ã—','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[18]',"01001039 FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«ã‚€ã•ã—æ‘å±±","01001039",]
hiratuka = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[19]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[19]','å¹³å¡š','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[19]',"01001040 FUNã‚‰ã‚‰ã½ãƒ¼ã¨æ¹˜å—å¹³å¡š","01001040",]
natori = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[20]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[20]','åå–','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[20]',"01001041 FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«åå–","01001041",]
otaka = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[21]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[21]','å¤§é«˜','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[21]',"01001042 FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å¤§é«˜","01001042",]
togocyo = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[22]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[22]','æ±éƒ·ç”º','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[22]',"01001043 FUNã‚‰ã‚‰ã½ãƒ¼ã¨æ„›çŸ¥æ±éƒ·","01001043",]
ota = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[23]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[23]','å¤ªç”°','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[23]',"01001044 FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å¤ªç”°","01001044",]
mito = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[24]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[24]','æ°´æˆ¸','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[24]',"01001045 FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«æ°´æˆ¸å†…åŸ","01001045",]
expo = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[25]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[25]','EXPO','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[25]',"01001046 FUNã‚‰ã‚‰ã½ãƒ¼ã¨EXPOCITY","01001046",]
kawasaki = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[26]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[26]','å·å´','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[26]',"01001047 FUNãƒ©ã‚¾ãƒ¼ãƒŠå·å´ãƒ—ãƒ©ã‚¶","01001047",]
sinmisato = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[27]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[27]','æ–°ä¸‰éƒ·','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[27]',"01001048 FUNã‚‰ã‚‰ã½ãƒ¼ã¨æ–°ä¸‰éƒ·","01001048",]
makuhari = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[28]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[28]','å¹•å¼µ','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[28]',"01001049 FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å¹•å¼µæ–°éƒ½å¿ƒ","01001049",]
kagamihara = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[29]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[29]','å„å‹™åŸ','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[29]',"01001050 FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å„å‹™åŸ","01001050",]
sakai = ['//*[@id="ContentPlaceHolder1_DropDownListCond04"]/option[30]','//*[@id="ContentPlaceHolder1_DropDownListCond05"]/option[30]','å º','//*[@id="ContentPlaceHolder1_DropDownList9"]/option[30]',"01001051 FUNã‚‰ã‚‰ã½ãƒ¼ã¨å º","01001051",]



tenpo_list = [
  kasiwa,
  chiba,
  isesaki,
  # nagamachi,
  # hunabashi,
  hujimi,
  reiku,
  ebina,
  musashi,
  hiratuka,
  natori,
  otaka,
  togocyo,
  ota,
  mito,
  expo,
  kawasaki,
  sinmisato,
  makuhari,
  kagamihara,
  sakai,
  ]

SHOP_KEYs = [
    'FUNæŸ',
    'FUNåƒè‘‰C-one',
    'FUNã‚¹ãƒãƒ¼ã‚¯ä¼Šå‹¢å´',
    'FUNã‚‰ã‚‰ã½ãƒ¼ã¨å¯Œå£«è¦‹',
    'FUNã‚¤ã‚ªãƒ³ãƒ¬ã‚¤ã‚¯ã‚¿ã‚¦ãƒ³',
    'FUNã‚‰ã‚‰ã½ãƒ¼ã¨æµ·è€å',
    'FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«ã‚€ã•ã—æ‘å±±',
    'FUNã‚‰ã‚‰ã½ãƒ¼ã¨æ¹˜å—å¹³å¡š',
    'FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«åå–',
    'FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å¤§é«˜',
    'FUNã‚‰ã‚‰ã½ãƒ¼ã¨æ„›çŸ¥æ±éƒ·',
    'FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å¤ªç”°',
    'FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«æ°´æˆ¸å†…åŸ',
    'FUNã‚‰ã‚‰ã½ãƒ¼ã¨EXPOCITY',
    'FUNãƒ©ã‚¾ãƒ¼ãƒŠå·å´ãƒ—ãƒ©ã‚¶',
    'FUNã‚‰ã‚‰ã½ãƒ¼ã¨æ–°ä¸‰éƒ·',
    'FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å¹•å¼µæ–°éƒ½å¿ƒ',
    'FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«å„å‹™åŸ',
    'FUNã‚‰ã‚‰ã½ãƒ¼ã¨å º',

]

ToDay = datetime.date.today()
y = ToDay.year
m = ToDay.month
d = ToDay.day


def download() :
    #ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼å‰å›ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

    #ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼å‰å›ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

    dr_files = 'C:/Users/å¤å†…ç¿”å¹³/OneDrive - æ ªå¼ä¼šç¤¾ã€€ï¼´ï¼²ï¼©ï¼®ï¼©ï¼´ï¼¹ã€€/æ¥­å‹™ä¼šè­°/4âƒ£è²©å£²éƒ¨/å¤å†…/analysis/inventory'
    dr_read = os.listdir(dr_files)


    for file_name in dr_read:
        del_f_path = dr_files + '/' + file_name#å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®è¨­å®š
        os.remove(del_f_path)#datafå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
        
    del_folder_path = "C:/Users/å¤å†…ç¿”å¹³/OneDrive - æ ªå¼ä¼šç¤¾ã€€ï¼´ï¼²ï¼©ï¼®ï¼©ï¼´ï¼¹ã€€/æ¥­å‹™ä¼šè­°/4âƒ£è²©å£²éƒ¨/å¤å†…/myfile/basket-analysis/data-folder"#å‰Šé™¤å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼

    del_read = os.listdir(del_folder_path)#å‰Šé™¤å¯¾è±¡ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—


    for del_file_name in del_read:
        del_faile_path = del_folder_path + '/' + del_file_name#å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®è¨­å®š
        os.remove(del_faile_path)#datafå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
        
    print('å‰Šé™¤å®Œäº†')      
        
    #---------------------------------------------------ã€
    
    ToDay = datetime.date.today()
    y = ToDay.year
    m = ToDay.month
    d = ToDay.day
    
    #period1 = str(y) + "0101"
    #period2 = str(y) + str(m).zfill(2) + str(d).zfill(2)
    
    period1 = "20231217"
    period2 = str(y) + str(m).zfill(2) + str(d).zfill(2)

    url = 'http://tri.hanbai-net.com/system/Login.aspx'
    
    chrome_options = Options()
    chrome_options.add_experimental_option("detach", True)

    driver = webdriver.Chrome(service=ChromeServeice(ChromeDriverManager().install()))

    driver.get(url)

    id_1 = 'trinityadmin'
    id_2 = 'AdminTrinity'


    loginid_1 = driver.find_element(By.ID, "ContentPlaceHolder1_txtUserCode")
    loginid_2 = driver.find_element(By.ID, "ContentPlaceHolder1_txtPassword")

    loginid_1.send_keys(id_1)#ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å…¥åŠ›
    loginid_2.send_keys(id_2)#ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›


    #ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    driver.find_element(By.ID, "ContentPlaceHolder1_btnLogin").click()


    time.sleep(2)
    
    driver.get('http://tri.hanbai-net.com/system/50010201.aspx?id=010199')



    driver.find_element(By.ID,"ContentPlaceHolder1_txtCond07").clear()#æ—¥ä»˜ã‚¯ãƒªã‚¢

    driver.find_element(By.ID,"ContentPlaceHolder1_txtCond07").send_keys(period1)#æ—¥ä»˜å…¥åŠ›(å‰)

    driver.find_element(By.ID,"ContentPlaceHolder1_txtCond10").clear()#æ—¥ä»˜ã‚¯ãƒªã‚¢

    driver.find_element(By.ID,"ContentPlaceHolder1_txtCond10").send_keys(period2)#æ—¥ä»˜å…¥åŠ›(å¾Œ)

    # driver.find_element(By.ID,"ContentPlaceHolder1_btnCondRun").click()#æ¤œç´¢

    # time.sleep(5)
    driver.find_element(By.XPATH,'//*[@id="ContentPlaceHolder1_DropDownList10"]').send_keys("0 è²©å£²")

    driver.find_element(By.ID,"ContentPlaceHolder1_btnCSV").click()#CSVå‡ºåŠ›

    time.sleep(10)#ä¸€æ™‚å¾…æ©Ÿ

    filelists = []
    for file in os.listdir("C:/Users/å¤å†…ç¿”å¹³/Downloads"):#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã‚’foræ–‡ã§å–ã‚Šå‡ºã™
        base, ext = os.path.splitext(file)#splitextã¯æ‹¡å¼µå­ã‚’å–å¾—ã™ã‚‹é–¢æ•°
        if ext == '.csv':#æ‹¡å¼µå­csvãŒä¸€è‡´ã—ãŸå ´åˆâ€¦
            if base == 'è²©å£²åˆ†æãƒ­ã‚°':
                filelists.append([file, os.path.getctime("C:/Users/å¤å†…ç¿”å¹³/Downloads/" + file)])#filelistsã«å–ã‚Šå‡ºã—ãŸfileã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚é–“ã‚’è¿½åŠ 
                #print("file:{},csv:{}" .format(file,csv))
                filelists.sort(key=itemgetter(0), reverse=True)#
                MAX_CNT = 0
                for i, file in enumerate(filelists):
                    if i > MAX_CNT-1:
                        print(file[0])
                        time.sleep(2)
                        #file_1 = os.rename(i[0], 'kasi.csv')
                        #os.rename("C:/Users/å¤å†…ç¿”å¹³/Downloads/è²©å£²åˆ†æãƒ­ã‚°.csv", 'é¡§å®¢ãƒ‡ãƒ¼ã‚¿.csv')
                        shutil.move('C:/Users/å¤å†…ç¿”å¹³/Downloads/è²©å£²åˆ†æãƒ­ã‚°.csv','C:/Users/å¤å†…ç¿”å¹³/OneDrive - æ ªå¼ä¼šç¤¾ã€€ï¼´ï¼²ï¼©ï¼®ï¼©ï¼´ï¼¹ã€€/æ¥­å‹™ä¼šè­°/4âƒ£è²©å£²éƒ¨/å¤å†…/myfile/basket-analysis/data-folder')                        
    time.sleep(3)  
      

    driver.get('http://tri.hanbai-net.com/system/21026001.aspx?id=010199')#åœ¨åº«ä¸€è¦§

    #CSV
    driver.find_element(By.ID, "ContentPlaceHolder1_btnCSV").click()
    time.sleep(5)

    filelists = []

    for file in os.listdir("C:/Users/å¤å†…ç¿”å¹³/Downloads"):#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã‚’foræ–‡ã§å–ã‚Šå‡ºã™
        base, ext = os.path.splitext(file)#splitextã¯æ‹¡å¼µå­ã‚’å–å¾—ã™ã‚‹é–¢æ•°
        if ext == '.csv':#æ‹¡å¼µå­csvãŒä¸€è‡´ã—ãŸå ´åˆâ€¦
            if base == 'åœ¨åº«ä¸€è¦§_':
                filelists.append([file, os.path.getctime("C:/Users/å¤å†…ç¿”å¹³/Downloads/" + str(file))])#filelistsã«å–ã‚Šå‡ºã—ãŸfileã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚é–“ã‚’è¿½åŠ 
                filelists.sort(key=itemgetter(0), reverse=True)#
                MAX_CNT = 0
                for i, file in enumerate(filelists):
                    if i > MAX_CNT-1:

                        os.rename("C:/Users/å¤å†…ç¿”å¹³/Downloads/" + str(file[0]), "C:/Users/å¤å†…ç¿”å¹³/Downloads/" + str("å…¨åº—") + '.csv')
                        shutil.move("C:/Users/å¤å†…ç¿”å¹³/Downloads/" + str("å…¨åº—") + '.csv' ,'C:/Users/å¤å†…ç¿”å¹³/OneDrive - æ ªå¼ä¼šç¤¾ã€€ï¼´ï¼²ï¼©ï¼®ï¼©ï¼´ï¼¹ã€€/æ¥­å‹™ä¼šè­°/4âƒ£è²©å£²éƒ¨/å¤å†…/analysis/inventory')                        
    time.sleep(5)    
    
    driver.close()
    
    return y

#--------åº—åˆ¥---------
download()

TargetCD = "1188999007000"
#åœ¨åº«ãƒ‡ãƒ¼ã‚¿
r_file = pd.read_csv('C:/Users/å¤å†…ç¿”å¹³/OneDrive - æ ªå¼ä¼šç¤¾ã€€ï¼´ï¼²ï¼©ï¼®ï¼©ï¼´ï¼¹ã€€/æ¥­å‹™ä¼šè­°/4âƒ£è²©å£²éƒ¨/å¤å†…/analysis/inventory/å…¨åº—.csv',encoding='cp932')
df = pd.DataFrame(r_file)

#å£²ä¸Šãƒ‡ãƒ¼ã‚¿
r_file2 = pd.read_csv('C:/Users/å¤å†…ç¿”å¹³/OneDrive - æ ªå¼ä¼šç¤¾ã€€ï¼´ï¼²ï¼©ï¼®ï¼©ï¼´ï¼¹ã€€/æ¥­å‹™ä¼šè­°/4âƒ£è²©å£²éƒ¨/å¤å†…/myfile/basket-analysis/data-folder/è²©å£²åˆ†æãƒ­ã‚°.csv',encoding='cp932')
df2 = pd.DataFrame(r_file2)

Target_df = df[df["å•†å“ã‚³ãƒ¼ãƒ‰"] == TargetCD ].sort_values("ç¾åœ¨æ•°é‡",ascending=False)
Target_df2 = df2[df2["å•†å“ã‚³ãƒ¼ãƒ‰"] == TargetCD ]
print(Target_df2)



HappyBag = []
for i in SHOP_KEYs :
    if i != "FUNã‚¤ã‚ªãƒ³ãƒ¢ãƒ¼ãƒ«æ°´æˆ¸å†…åŸ" :
    #try:
        Data = Target_df[Target_df["æ‹ ç‚¹å"] == i]
        Data2 = sum(Target_df2[Target_df2["åº—èˆ—å"] == i].values)
        print(Data.values)
        HappyBag.append(pd.DataFrame([{"åº—èˆ—":Data.values[0][1],"åœ¨åº«æ•°":Data.values[0][10],"å£²ä¸Šæ•°é‡":Data2}]))
    else:
    #except :
        HappyBag.append(pd.DataFrame([{"åº—èˆ—":i,"åœ¨åº«æ•°":0,"å£²ä¸Šæ•°é‡":Data2}]))
        
        #HappyBag.append([i,"å®Œå£²"])
    
print(HappyBag)             
        
HappyBagInventory = pd.concat(HappyBag).sort_values("åœ¨åº«æ•°",ascending=False)
print(HappyBagInventory)

  
TOKEN = 'NxPDQg0tpI4oY6BZHo7vkZ3gxPtTIijpWFyN85xL2q1'#ãƒ†ã‚¹ãƒˆã®éƒ¨å±‹ãƒˆãƒ¼ã‚¯ãƒ³
#TOKEN = 'TNKXBcpEMmK4JAmRPaOyVABkA5GWIJkIHQOnsyfu4MD'#FUNã®éƒ¨å±‹ãƒˆãƒ¼ã‚¯ãƒ³
api_url = 'https://notify-api.line.me/api/notify'
headers = {'Authorization' : 'Bearer ' + TOKEN}

message_1 = ( '\nç¦è¢‹æ®‹åœ¨åº«å ±å‘Š\n' +  str(y) + 'å¹´' + str(m) + 'æœˆ' + str(d) + 'æ—¥å®Ÿç¸¾' +'\n'+
            'â€»æ®‹åœ¨åº«å¤šã„é †'+'\n'+'\n'+
           '1ä½ ' + str([ i[0] for i in HappyBagInventory.values][0]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][0]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][0]) + '\n' +'\n' 
           
           '2ä½ ' + str([ i[0] for i in HappyBagInventory.values][1]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][1]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][1]) + '\n' +'\n' 
           
           
           '3ä½ ' + str([ i[0] for i in HappyBagInventory.values][2]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][2]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][2]) + '\n' +'\n' 
           
           
           '4ä½ ' + str([ i[0] for i in HappyBagInventory.values][3]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][3]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][3]) + '\n' +'\n' 
           
           
           '5ä½ ' + str([ i[0] for i in HappyBagInventory.values][4]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][4]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][4]) + '\n' +'\n' 
           
           
           '6ä½ ' + str([ i[0] for i in HappyBagInventory.values][5]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][5]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][5]) + '\n' +'\n' 
           
           
           '7ä½ ' + str([ i[0] for i in HappyBagInventory.values][6]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][6]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][6]) + '\n' +'\n' 
           
           
           '8ä½ ' + str([ i[0] for i in HappyBagInventory.values][7]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][7]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][7]) + '\n' +'\n' 
           
           
           '9ä½ ' + str([ i[0] for i in HappyBagInventory.values][8]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][8]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][8]) + '\n' +'\n' 
           
           
           '10ä½ ' + str([ i[0] for i in HappyBagInventory.values][9]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][9]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][9]) + '\n' +'\n' 
           
           '11ä½ ' + str([ i[0] for i in HappyBagInventory.values][10]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][10]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][10]) + '\n' +'\n' 
           
           '12ä½ ' + str([ i[0] for i in HappyBagInventory.values][11]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][11]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][11]) + '\n' +'\n' 
           
           '13ä½ ' + str([ i[0] for i in HappyBagInventory.values][12]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][12]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][12]) + '\n' +'\n' 
           
           '14ä½ ' + str([ i[0] for i in HappyBagInventory.values][13]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][13]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][13]) + '\n' +'\n' 
           
           '15ä½ ' + str([ i[0] for i in HappyBagInventory.values][14]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][14]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][14]) + '\n' +'\n' 
           
           '16ä½ ' + str([ i[0] for i in HappyBagInventory.values][15]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][15]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][15]) + '\n' +'\n' 
           
           '17ä½ ' + str([ i[0] for i in HappyBagInventory.values][16]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][16]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][16]) + '\n' +'\n' 
           
           '18ä½ ' + str([ i[0] for i in HappyBagInventory.values][17]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][17]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][17]) + '\n' +'\n' 
           
           '19ä½ ' + str([ i[0] for i in HappyBagInventory.values][18]) + '\n' +
           ' æ®‹åœ¨åº«æ•° ' + str([ "ğŸŒŸå®Œå£²" if i[1] == 0 else i[1] for i in HappyBagInventory.values ][18]) + 'ã€€è²©å£²æ•°' + str([ i[2] for i in HappyBagInventory.values][18]) + '\n' +'\n' 
           
           'ã‚ˆã‚ã—ããŠé¡˜ã„è‡´ã—ã¾ã™ã€‚' + '\n' +'\n' 
           
           'å¤å†…' + '\n' +'\n' 

           )

#(+'\n'+'å²é˜œ'+str(p5)+'\n'+'é•·ç”º'+str(p6)+'\n'+'èˆ¹æ©‹'+str(p7)+'\n'+'å¯Œå£«è¦‹'+str(p8)+'\n'+'ãƒ¬ã‚¤ã‚¯'+str(p9)+'\n'+'æµ·è€å')
#(+str(p10)+'\n'+'ã‚€ã•ã—'+str(p11)+'\n'+'å¹³å¡š'+str(p12)+'\n'+'åå–'+str(p13)+'\n'+'å¤§é«˜'+str(p14)+'\n'+'æ±éƒ·ç”º'+str(p15)+'\n'+'å¤ªç”°'+str(p16)+'\n'+'æ°´æˆ¸'+str(p17)+'\n'+'EXPO'+str(p18)+'\n'+'å·å´'+str(p19)+'\n'+'æ–°ä¸‰éƒ·'+str(p20)+'\n'+'è©³ç´°ã¯OneDriveã®ã€ã‚·ãƒ•ãƒˆç®¡ç†ã€‘å£²ä¸Šå®Ÿç¸¾ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ä¸‹ã•ã„ï¼')
payload = {'message': message_1}
requests.post(api_url, headers=headers, params=payload)   
#print("SUCCESSFULL!!")

print("SUCCESSFULL!!")

#xlpy.load_workbook()

# from season_ana import season_analysis


# season_analysis()


